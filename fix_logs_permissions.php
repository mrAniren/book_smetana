<?php
error_reporting(E_ALL);
ini_set('display_errors', 1);

echo "<h1>üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ê–í –î–û–°–¢–£–ü–ê –ö –õ–û–ì–ê–ú</h1>";

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
echo "<h2>–¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:</h2>";
echo getcwd() . "<br>";

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ logs
echo "<h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ logs:</h2>";
if (is_dir('logs')) {
    echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è logs —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br>";
} else {
    echo "‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è logs –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br>";
    echo "–°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é logs...<br>";
    
    if (mkdir('logs', 0755, true)) {
        echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è logs —Å–æ–∑–¥–∞–Ω–∞<br>";
    } else {
        echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é logs<br>";
    }
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
echo "<h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:</h2>";
if (is_dir('logs')) {
    $perms = fileperms('logs');
    echo "–ü—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é logs: " . substr(sprintf('%o', $perms), -4) . "<br>";
    
    if (is_writable('logs')) {
        echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è logs –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏<br>";
    } else {
        echo "‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è logs –ù–ï –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏<br>";
        echo "–ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞...<br>";
        
        if (chmod('logs', 0755)) {
            echo "‚úÖ –ü—Ä–∞–≤–∞ –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ 755<br>";
        } else {
            echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞<br>";
        }
    }
}

// –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª—ã –ª–æ–≥–æ–≤
echo "<h2>–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤:</h2>";
$logFiles = ['error.log', 'info.log'];

foreach ($logFiles as $logFile) {
    $logPath = 'logs/' . $logFile;
    
    if (file_exists($logPath)) {
        echo "‚úÖ $logFile —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br>";
    } else {
        echo "–°–æ–∑–¥–∞–µ–º $logFile...<br>";
        
        if (file_put_contents($logPath, "Log file created at " . date('Y-m-d H:i:s') . "\n")) {
            echo "‚úÖ $logFile —Å–æ–∑–¥–∞–Ω<br>";
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª
            if (chmod($logPath, 0644)) {
                echo "‚úÖ –ü—Ä–∞–≤–∞ –Ω–∞ $logFile —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (644)<br>";
            } else {
                echo "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ $logFile<br>";
            }
        } else {
            echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å $logFile<br>";
        }
    }
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥
echo "<h2>–¢–µ—Å—Ç –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥:</h2>";
$testMessage = "Test log entry at " . date('Y-m-d H:i:s') . "\n";

if (file_put_contents('logs/info.log', $testMessage, FILE_APPEND | LOCK_EX)) {
    echo "‚úÖ –ó–∞–ø–∏—Å—å –≤ info.log —Ä–∞–±–æ—Ç–∞–µ—Ç<br>";
} else {
    echo "‚ùå –ó–∞–ø–∏—Å—å –≤ info.log –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç<br>";
}

if (file_put_contents('logs/error.log', $testMessage, FILE_APPEND | LOCK_EX)) {
    echo "‚úÖ –ó–∞–ø–∏—Å—å –≤ error.log —Ä–∞–±–æ—Ç–∞–µ—Ç<br>";
} else {
    echo "‚ùå –ó–∞–ø–∏—Å—å –≤ error.log –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç<br>";
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
echo "<h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:</h2>";
$rootPerms = fileperms('.');
echo "–ü—Ä–∞–≤–∞ –Ω–∞ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: " . substr(sprintf('%o', $rootPerms), -4) . "<br>";

if (is_writable('.')) {
    echo "‚úÖ –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏<br>";
} else {
    echo "‚ùå –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ù–ï –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏<br>";
}

// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
echo "<h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ:</h2>";
echo "PHP –≤–µ—Ä—Å–∏—è: " . PHP_VERSION . "<br>";
echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: " . get_current_user() . "<br>";
echo "–ì—Ä—É–ø–ø–∞: " . (function_exists('posix_getgrgid') ? posix_getgrgid(posix_getgid())['name'] : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ') . "<br>";

echo "<h1 style='color: green;'>üéâ –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!</h1>";
echo "<p><a href='install.php'>–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ</a></p>";
?>
